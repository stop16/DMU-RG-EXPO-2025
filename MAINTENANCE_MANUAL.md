# DMU-RG EXPO 2025 – Maintenance & Issue Response Manual

**(운영·유지보수 매뉴얼)**

이 문서는 EXPO 데모 시스템이 안정적으로 동작하도록 관리하는 절차를 정리한 것입니다.
설계 구조나 코드 설명이 필요할 경우 `PROJECT_DOCUMENTATION.md`를 참고하세요.

---

## 1. 유지보수 주기

| 주기             | 작업 항목                                                                |
| -------------- | -------------------------------------------------------------------- |
| **매일 (행사 전)**  | 하드웨어 점검(2장 참고), 최신 펌웨어 업로드, `automation_test.py` 시험 실행, RC 센서 반응 확인. |
| **운영 중**       | 콘솔 로그 확인, 스레드 정상동작(`지진 발생`, 도트매트릭스 동기화 등) 확인, RC카 트리거 주기 확인.         |
| **행사 종료 후**    | 전원 차단, 로그 보관, 이상 사항 기록.                                              |

---

## 2. 하드웨어 점검표

1. **전원 및 연결 상태**

   * 모든 아두이노가 안정적으로 연결돼 있는지 확인.
   * 케이블 단선·헐거움 점검, 필요 시 재삽입.
   * LED 스트립, 서보 구동 시 전압 강하(깜빡임) 없는지 확인.

2. **보드 식별**

   * 시리얼 터미널(115200 baud)에서 `q` 입력 → `'6'`, `'7'`, `'8'`, `'9'` 응답 확인.
   * 일치하지 않거나 응답이 없으면 해당 펌웨어 다시 업로드.

3. **주요 부품 테스트**

   * LED: `r`, `g`, `a` 전송해 색상 확인.
   * 도트매트릭스: `c`, `n`, `v`, `m` 테스트.
   * 지진 장치: `1 → 2 → 0 → 3` 순서로 짧게 동작 확인.
   * ToF/RC 센서: 물체를 근접시켜 `'o'` 신호 확인.

---

## 3. 소프트웨어 유지보수

1. **실행 환경**

   * 가상환경(`Python/.venv`) 사용 권장.
   * 패키지 업데이트:

     ```bash
     cd Python
     ./.venv/Scripts/activate
     pip install --upgrade pyserial PySide6
     ```
   * 업데이트 후 `integration_test.py`로 기본 통신 확인.

2. **환경 설정**

   * `PORT_LIST` 시리얼 순서와 실제 연결 순서 일치 확인.
   * USB 케이블에 보드 역할 라벨 부착 권장.

3. **문서화**

   * 절차 변경 시 `PROJECT_DOCUMENTATION.md`, `MAINTENANCE_MANUAL.md`, `How_to_run.md` 함께 수정.

---

## 4. 테스트 절차

| 테스트 종류                                       | 목적                  | 실행 시점      |
| -------------------------------------------- | ------------------- | ---------- |
| **Smoke Test (`test.py`)**                   | 기본 시리얼 통신·보드 식별 확인  | 하드웨어 재연결 후 |
| **Integration Test (`integration_test.py`)** | 수동 제어, LED/서보 동작 확인 | 보정 또는 점검 시 |
| **Automation Demo (`automation_test.py`)**   | 전체 시연 자동 흐름 확인      | 행사 전 리허설 시 |

> 이상 발견 시 8장 이슈 로그에 시간·증상·조치 내용을 남기세요.

---

## 5. 예방 정비

* 각 타입별 예비 플래시 보드 1세트 준비.
* 지진 장치용 3D 부품·기계부 여분 확보.
* 주요 소모품(LED, 서보, 센서, 점퍼선 등) 재고 관리.
* 배선도 출력본을 설치 근처에 비치.
* 행사 기간 중 2~3일 간격으로 서보 조정(나사·축 정렬).

---

## 6. 문제 대응 절차

| 증상                 | 원인 추정                             | 조치                                    |
| ------------------ | --------------------------------- | ------------------------------------- |
| **Python 실행 시 멈춤** | COM 순서 오류 또는 연결 해제                | `test.py` 재실행, 포트 재확인 후 케이블 재삽입       |
| **지진 효과 즉시 중단**    | 서보 걸림, `earthquake_active` 이벤트 충돌 | 기계부 장애 확인 후 리셋                        |
| **도트매트릭스 미반응**     | 보드 매핑(`obj_8`) 누락 또는 명령 불일치       | `integration_test.py`로 테스트 후 펌웨어 재업로드 |
| **RC카 미작동**        | ToF 센서 위치 불량 또는 `'o'` 신호 누락       | `test.py`로 센서 수동 테스트                  |
| **LED 깜빡임/약함**     | 전원 부족 또는 접지 문제                    | 전원 측정, 접지 재점검, 서보 부하 감소               |

> 문제 발생 시 다른 보드를 분리한 상태에서 단독 테스트 후 원인 판별.

---

## 7. 이슈 기록 및 보고 절차

1. **로그 작성**

   * 시간, 담당자, 증상, 영향받은 구성요소, 즉시 조치 내용 기록.
2. **우선순위 분류**

   * P0: 전체 중단 (즉시 대응)
   * P1: 부분 장애 (당일 수정)
   * P2: 경미한 버그 (기록 후 추후 개선)
3. **해결 후**

   * 원인·수정내용·예방조치 정리, 문서 갱신.

---

## 8. 펌웨어·프로토콜 변경 시

1. **계획 수립** – 변경 내용·명령어를 문서화.
2. **구현** – 아두이노와 Python 코드 동시 수정, 별도 브랜치 사용.
3. **검증** – 실물 테스트 및 통합 테스트 수행.
4. **배포** – 모든 보드 플래시, 펌웨어 버전 표기, 로그 업데이트.

---

## 9. 백업 및 복구

* **코드**: Git 백업 + 안정 태그(`expo-2025-stable`).
* **펌웨어**: `.hex` 파일 백업(`firmware_backups/`).
* **설정값**: `PORT_LIST`, GUI 세팅, 보정값 저장.
* **로그**: 일일 콘솔 출력·이슈 로그 보관.

**복구 절차**

1. 안정 커밋 체크아웃 → 2. 펌웨어 재플래시 →
2. Python 환경 복원(`pip install -r requirements.txt`) →
3. `automation_test.py`로 최종 확인.